function customerName(){customer_name=$("#customer_name").val(),console.log("Customer Name: ",customer_name),customer_name.length>2&&triggerUiUpdate()}function triggerUiUpdate(){state=$("#state_scope").val(),lga=$("#lga_scope").val(),bank=$("#bank_scope").val(),customer_name=$("#customer_name").val(),console.log("All Seleceted: ",state+"  "+customer_name+"  "+bank);var t=buildQuery(state,customer_name,bank);download_query=t.replace("http:","https:").replace("format=GeoJSON&","")+"&format=CSV",document.getElementById("query").setAttribute("href",download_query),getData(t),console.log("QUERY:  ",t),prefecture_select=$("#state_scope").val()}function buildQuery(t,e,n){var i=!1;return query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM datapro_visualization",t.length>0||e>2||n.length>0?(query=query.concat(" WHERE"),t.length>0&&(query=query.concat(" state = '".concat(t.concat("'"))),i=!0),e.length>2&&(query=i?query.concat(" AND customer_name LIKE '%25".concat(e.concat("%25'"))).concat(" OR customer_name LIKE '%25".concat(e.charAt(0).toUpperCase()+e.slice(1).concat("%25'"))):query.concat(" customer_name LIKE '%25".concat(e.concat("%25'"))).concat(" OR customer_name LIKE '%25".concat(e.charAt(0).toUpperCase()+e.slice(1).concat("%25'"))),i=!0),n.length>0&&(query=query.concat(i?" AND bank = '".concat(n.concat("'")):" bank = '".concat(n.concat("'"))),i=!0)):query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM datapro_visualization",query}function addDataToMap(t){null!=dataLayer&&map.removeLayer(dataLayer),null!=markerGroup&&map.removeLayer(markerGroup);var e=L.icon({iconUrl:"image/user1.jpg",iconSize:[20,20],iconAnchor:[25,25]});$("#projectCount").text(t.features.length),markerGroup=L.markerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0}),dataLayer=L.geoJson(t,{pointToLayer:function(t,n){var i=L.marker(n,{icon:e});return i},onEachFeature:function(t,e){t.properties&&t.properties.cartodb_id&&e.on("click",function(){displayInfo(t)})}}),markerGroup.addLayer(dataLayer),map.fitBounds(dataLayer),map.addLayer(markerGroup)}function addAdminLayersToMap(t){var e={admin0:{clickable:!0,color:"#B81609",fillColor:"#ffffff",weight:2,opacity:1,fillOpacity:.05},admin2:{clickable:!0,color:"#412406",fillColor:"#80FFFFFF",weight:1.5,opacity:.5,fillOpacity:.05},region:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2,opacity:.7,fillOpacity:.05},prefecture:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2.5,opacity:.7,fillOpacity:.05}};stateSelect=$("#state_scope").val(),lgaSelect=$("#lga_scope").val(),console.log("State_LGA: ",stateSelect+"  "+lgaSelect),nigeriaAdminLayer0=L.geoJson(t.nigeriaAdmin0,{style:e.admin0}).addTo(map),nigeriaAdminLayer2=L.geoJson(t.nigeriaAdmin2,{style:e.region,onEachFeature:function(t,e){var n=L.divIcon({className:"labelLga-icon",html:t.properties.LGAName});NGRLabels.push(L.marker(e.getBounds().getCenter(),{icon:n}))}}),null!=state_layer&&map.removeLayer(state_layer),state_layer=L.geoJson(t.nigeriaAdmin1,{filter:function(t){return t.properties.StateName===stateSelect},style:e.region}).addTo(map),console.log(state_layer),map.fitBounds(state_layer.getBounds()),null!=lga_layer&&map.removeLayer(lga_layer),lga_layer=L.geoJson(t.nigeriaAdmin2,{filter:function(t){return t.properties.LGAName===lgaSelect},style:e.region}).addTo(map),map.fitBounds(lga_layer.getBounds()),console.log("Zoom Level ",map.getZoom())}function displayInfo(t){var e=buildPopupContent(t);$("#infoContent").html(e)}function normalizeName(t){return t=t.replace("_"," ").replace("of_"," of "),t=t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}function buildPopupContent(t){for(var e="",n=["bank","customer_name","risk_score","lga","ref_no","address","nearest_bustop","type_of_structure","landmark","name_of_landmark","customer_status","client","contact_name","convinction","visiting_officer_name","verification_status"],i=0;i<n.length;i++)e=e.concat("<p><strong>"+normalizeName(n[i])+": </strong>"+t.properties[n[i]]+"</p>");return e}function showLoader(){$(".fa-spinner").addClass("fa-spin"),$(".fa-spinner").show()}function hideLoader(){$(".fa-spinner").removeClass("fa-spin"),$(".fa-spinner").hide()}function getData(t){showLoader(),$.post(t,function(t){hideLoader(),addDataToMap(t),console.log("Data-Geo::  ",t)}).fail(function(){console.log("error!")})}function getAdminLayers(){var t={};$.get("resources/NGR_Admin0.json",function(e){t.nigeriaAdmin0=e,$.get("resources/NGR_Admin1.json",function(e){t.nigeriaAdmin1=e,$.get("resources/NGR_Admin2.json",function(e){t.nigeriaAdmin2=e,addAdminLayersToMap(t)}).fail(function(){logError(null)})}).fail(function(){logError(null)})}).fail(function(){logError(null)})}function logError(){console.log("error!")}var d,m,y,date,type="",distance,state,twokm,threekm,fourkm,region="",prefecture="",prefecture_select="",sub_prefecture="",geoData=null,dataLayer=null,markerGroup=null,nigeriaAdminLayer0,nigeriaAdminLayer1,nigeriaAdminLayer2,country_layer=null,state_layer=null,lga_layer=null,ward_layer=null,bufferLayer=null,substance_layer=null,NGRLabels=[],within,within_fc,buffered=null,NGRAdmin2=!1,googleSat=L.tileLayer("https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),googleStreets=L.tileLayer("https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),osm=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20}),mapbox=L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicy1jaGFuZCIsImEiOiJjaXdmcmtnc2QwMDBhMnltczBldmc1MHZuIn0.eIdXZvG0VOOcZhhoHpUQYA"),map=L.map("map",{center:[10,8],zoom:6,zoomControl:!1,layers:[osm],minZoom:6,maxZoom:22}),baseMaps={"Google Satelite":googleSat,OSM:osm,"Google Street":googleStreets,"Map Box":mapbox};map.on("zoomend",function(){}),new L.Control.Zoom({position:"bottomright"}).addTo(map),L.control.layers(baseMaps).addTo(map),getAdminLayers(),hideLoader();
//# sourceMappingURL=main.min.js.map